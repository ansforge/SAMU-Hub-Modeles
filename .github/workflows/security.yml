name: Security Scan

on:
  push:
    branches:
      - main
      - develop
      - chore/security/ci-code-scan
  pull_request:
    branches:
      - main
      - develop
      - chore/security/ci-code-scan
  schedule:
    # Run weekly on Mondays at 3 AM UTC
    - cron: '0 3 * * 1'
  workflow_dispatch:

jobs:
  # Security scan for the main Java library
  security-scan-library:
    uses: ./.github/workflows/security-scan.yml
    with:
      working-directory: '.'
      component-name: 'library'
      dependency-scan: false
      scan-dockerfile: false
    secrets: inherit

  # Security scan for the Python converter
  security-scan-converter:
    uses: ./.github/workflows/security-scan.yml
    with:
      working-directory: 'converter'
      component-name: 'converter'
      dependency-scan: true
      scan-dockerfile: true
    secrets: inherit

  # Security scan for Python CSV parser
  security-scan-csv-parser:
    uses: ./.github/workflows/security-scan.yml
    with:
      working-directory: 'csv_parser'
      component-name: 'csv-parser'
      dependency-scan: false
      scan-dockerfile: false
    secrets: inherit

  # Security scan for Python nomenclature parser
  security-scan-nomenclature-parser:
    uses: ./.github/workflows/security-scan.yml
    with:
      working-directory: 'nomenclature_parser'
      component-name: 'nomenclature-parser'
      dependency-scan: false
      scan-dockerfile: false
    secrets: inherit

  # Security scan for web specs
  security-scan-web-specs:
    uses: ./.github/workflows/security-scan.yml
    with:
      working-directory: 'web_specs'
      component-name: 'web-specs'
      dependency-scan: false
      scan-dockerfile: true
    secrets: inherit